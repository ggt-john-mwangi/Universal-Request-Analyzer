<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universal Request Analyzer - Config</title>
    <link rel="stylesheet" href="../css/themes.css" />
    <link rel="stylesheet" href="../assets/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="css/options.css" />
    <link rel="stylesheet" href="css/data-purge.css" />
    <script src="../lib/shared-theme-init.js"></script>
  </head>

  <body>
    <div id="app" class="dashboard-layout">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <img
            src="../assets/icons/icon48.png"
            alt="URA"
            class="sidebar-logo"
          />
          <h1 class="sidebar-title">URA Dashboard</h1>
        </div>

        <nav class="sidebar-nav">
          <button class="nav-item active" data-tab="dashboard">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
          </button>
          <button class="nav-item" data-tab="general">
            <i class="fas fa-cog"></i>
            <span>General</span>
          </button>
          <button class="nav-item" data-tab="alerts">
            <i class="fas fa-bell"></i>
            <span>Alerts</span>
          </button>
          <button class="nav-item" data-tab="export">
            <i class="fas fa-file-export"></i>
            <span>Export</span>
          </button>
          <button class="nav-item" data-tab="retention">
            <i class="fas fa-database"></i>
            <span>Data Management</span>
          </button>
          <button class="nav-item" data-tab="security">
            <i class="fas fa-shield-alt"></i>
            <span>Security</span>
          </button>
          <button class="nav-item" data-tab="themes">
            <i class="fas fa-palette"></i>
            <span>Themes</span>
          </button>
          <button class="nav-item" data-tab="advanced">
            <i class="fas fa-code"></i>
            <span>Advanced</span>
          </button>
        </nav>

        <div class="sidebar-footer">
          <div class="version-info">
            <i class="fas fa-info-circle"></i>
            <span>Version 1.0.0</span>
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <div class="main-area">
        <header class="content-header">
          <h1 id="pageTitle">Dashboard</h1>
          <div class="header-actions">
            <button id="saveAllBtn" class="btn-primary">
              <i class="fas fa-save"></i> Save All
            </button>
          </div>
        </header>

        <main class="content-body">
          <!-- Dashboard Tab -->
          <section id="dashboard" class="tab-content active">
            <div class="dashboard-container">
              <div class="dashboard-header">
                <h2>
                  <i class="fas fa-tachometer-alt"></i> Dashboard
                  <span
                    style="
                      font-size: 12px;
                      font-weight: normal;
                      color: var(--text-secondary-color, #718096);
                      margin-left: 8px;
                    "
                  >
                    (Analytics & Performance)
                  </span>
                </h2>
                <div class="dashboard-controls">
                  <button
                    id="dashboardFilterToggle"
                    class="filter-toggle-btn"
                    title="Toggle Filters"
                  >
                    <i class="fas fa-filter"></i> Filters
                    <i class="fas fa-chevron-down toggle-icon"></i>
                  </button>
                  <label>
                    <input type="checkbox" id="dashboardAutoRefresh" checked />
                    <span>Auto-refresh</span>
                  </label>
                  <select id="dashboardTimeRange">
                    <option value="3600">Last Hour</option>
                    <option value="21600">Last 6 Hours</option>
                    <option value="86400" selected>Last 24 Hours</option>
                    <option value="604800">Last 7 Days</option>
                  </select>
                  <button id="dashboardRefresh" class="btn-primary">
                    <i class="fas fa-sync-alt"></i> Refresh
                  </button>
                </div>
              </div>

              <!-- Active Filters Info -->
              <div
                id="dashboardActiveFilters"
                class="active-filters-info"
                style="
                  display: none;
                  padding: 12px;
                  background: var(--info-light, #e3f2fd);
                  border: 1px solid var(--info-color, #2196f3);
                  border-radius: 4px;
                  margin-bottom: 16px;
                "
              >
                <div style="display: flex; align-items: center; gap: 8px">
                  <i
                    class="fas fa-info-circle"
                    style="color: var(--info-color, #2196f3)"
                  ></i>
                  <span
                    id="activeFiltersText"
                    style="color: var(--text-primary); font-size: 14px"
                  ></span>
                </div>
              </div>

              <!-- Collapsible Filter Panel -->
              <div id="dashboardFilterPanel" class="filter-panel">
                <div class="filter-panel-content">
                  <div class="filter-group">
                    <label>
                      <span><i class="fas fa-globe"></i> Domain:</span>
                      <select
                        id="dashboardDomainFilter"
                        style="min-width: 200px"
                      >
                        <option value="all">All Domains</option>
                      </select>
                    </label>
                  </div>
                  <div class="filter-group">
                    <label>
                      <span><i class="fas fa-file"></i> Page:</span>
                      <select id="dashboardPageFilter" style="min-width: 200px">
                        <option value="">All Pages (Aggregated)</option>
                      </select>
                    </label>
                  </div>
                  <div class="filter-group">
                    <label>
                      <span><i class="fas fa-filter"></i> Type:</span>
                      <select
                        id="dashboardRequestTypeFilter"
                        style="min-width: 120px"
                      >
                        <option value="">All Types</option>
                        <option value="xmlhttprequest">XHR/API</option>
                        <option value="fetch">Fetch</option>
                        <option value="script">Scripts</option>
                        <option value="stylesheet">Stylesheets</option>
                        <option value="image">Images</option>
                        <option value="font">Fonts</option>
                        <option value="document">Documents</option>
                        <option value="other">Other</option>
                      </select>
                    </label>
                  </div>
                </div>
              </div>

              <!-- Loading Indicator -->
              <div
                id="dashboardLoading"
                class="loading-indicator"
                style="display: none"
              >
                <i class="fas fa-spinner fa-spin"></i> Loading dashboard data...
              </div>

              <!-- Key Metrics Cards -->
              <div class="metrics-grid">
                <div class="metric-card">
                  <div class="metric-icon success">
                    <i class="fas fa-network-wired"></i>
                  </div>
                  <div class="metric-content">
                    <div class="metric-label">Total Requests</div>
                    <div class="metric-value" id="dashTotalRequests">0</div>
                    <div class="metric-change positive" id="dashTotalChange">
                      +0%
                    </div>
                  </div>
                </div>

                <div class="metric-card">
                  <div class="metric-icon info">
                    <i class="fas fa-clock"></i>
                  </div>
                  <div class="metric-content">
                    <div class="metric-label">Avg Response Time</div>
                    <div class="metric-value" id="dashAvgResponse">0ms</div>
                    <div class="metric-change" id="dashAvgChange">+0%</div>
                  </div>
                </div>

                <div class="metric-card">
                  <div class="metric-icon warning">
                    <i class="fas fa-exclamation-triangle"></i>
                  </div>
                  <div class="metric-content">
                    <div class="metric-label">Slow Requests</div>
                    <div class="metric-value" id="dashSlowRequests">0</div>
                    <div class="metric-change" id="dashSlowChange">+0%</div>
                  </div>
                </div>

                <div class="metric-card">
                  <div class="metric-icon error">
                    <i class="fas fa-times-circle"></i>
                  </div>
                  <div class="metric-content">
                    <div class="metric-label">Error Rate</div>
                    <div class="metric-value" id="dashErrorRate">0%</div>
                    <div class="metric-change" id="dashErrorChange">+0%</div>
                  </div>
                </div>
              </div>

              <!-- Dashboard Sub-Tabs Navigation -->
              <div class="dashboard-tabs">
                <div class="tabs-nav">
                  <button data-tab="overview" class="dashboard-tab-btn active">
                    <i class="fas fa-chart-line"></i> Overview
                  </button>
                  <button data-tab="requests" class="dashboard-tab-btn">
                    <i class="fas fa-list"></i> Requests
                  </button>
                  <button data-tab="performance" class="dashboard-tab-btn">
                    <i class="fas fa-stopwatch"></i> Performance
                  </button>
                  <button data-tab="resources" class="dashboard-tab-btn">
                    <i class="fas fa-database"></i> Resources
                  </button>
                  <button data-tab="errors" class="dashboard-tab-btn">
                    <i class="fas fa-bug"></i> Errors
                  </button>
                  <button data-tab="analytics" class="dashboard-tab-btn">
                    <i class="fas fa-chart-bar"></i> Analytics
                  </button>
                </div>

                <!-- Overview Tab -->
                <div
                  class="dashboard-tab-content active"
                  data-tab-content="overview"
                >
                  <!-- Core Web Vitals Section -->
                  <div class="web-vitals-section">
                    <h3>
                      <i class="fas fa-tachometer-alt"></i> Core Web Vitals
                    </h3>
                    <div class="web-vitals-grid">
                      <div class="vital-card" id="lcpCard">
                        <div class="vital-icon">
                          <i class="fas fa-image"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">LCP</div>
                          <div class="vital-subtitle">
                            Largest Contentful Paint
                          </div>
                          <div class="vital-value" id="lcpValue">-</div>
                          <div class="vital-rating" id="lcpRating"></div>
                          <div class="vital-target">Target: &lt; 2.5s</div>
                        </div>
                      </div>

                      <div class="vital-card" id="fidCard">
                        <div class="vital-icon">
                          <i class="fas fa-mouse-pointer"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">FID</div>
                          <div class="vital-subtitle">First Input Delay</div>
                          <div class="vital-value" id="fidValue">-</div>
                          <div class="vital-rating" id="fidRating"></div>
                          <div class="vital-target">Target: &lt; 100ms</div>
                        </div>
                      </div>

                      <div class="vital-card" id="clsCard">
                        <div class="vital-icon">
                          <i class="fas fa-arrows-alt"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">CLS</div>
                          <div class="vital-subtitle">
                            Cumulative Layout Shift
                          </div>
                          <div class="vital-value" id="clsValue">-</div>
                          <div class="vital-rating" id="clsRating"></div>
                          <div class="vital-target">Target: &lt; 0.1</div>
                        </div>
                      </div>

                      <div class="vital-card" id="fcpCard">
                        <div class="vital-icon">
                          <i class="fas fa-paint-brush"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">FCP</div>
                          <div class="vital-subtitle">
                            First Contentful Paint
                          </div>
                          <div class="vital-value" id="fcpValue">-</div>
                          <div class="vital-rating" id="fcpRating"></div>
                          <div class="vital-target">Target: &lt; 1.8s</div>
                        </div>
                      </div>

                      <div class="vital-card" id="ttfbCard">
                        <div class="vital-icon">
                          <i class="fas fa-server"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">TTFB</div>
                          <div class="vital-subtitle">Time to First Byte</div>
                          <div class="vital-value" id="ttfbValue">-</div>
                          <div class="vital-rating" id="ttfbRating"></div>
                          <div class="vital-target">Target: &lt; 800ms</div>
                        </div>
                      </div>

                      <div class="vital-card" id="ttiCard">
                        <div class="vital-icon">
                          <i class="fas fa-hand-pointer"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">TTI</div>
                          <div class="vital-subtitle">Time to Interactive</div>
                          <div class="vital-value" id="ttiValue">-</div>
                          <div class="vital-rating" id="ttiRating"></div>
                          <div class="vital-target">Target: &lt; 3.8s</div>
                        </div>
                      </div>

                      <div class="vital-card" id="dclCard">
                        <div class="vital-icon">
                          <i class="fas fa-file-code"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">DCL</div>
                          <div class="vital-subtitle">DOMContentLoaded</div>
                          <div class="vital-value" id="dclValue">-</div>
                          <div class="vital-rating" id="dclRating"></div>
                          <div class="vital-target">Target: &lt; 1.5s</div>
                        </div>
                      </div>

                      <div class="vital-card" id="loadCard">
                        <div class="vital-icon">
                          <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="vital-content">
                          <div class="vital-label">Load</div>
                          <div class="vital-subtitle">Page Load Complete</div>
                          <div class="vital-value" id="loadValue">-</div>
                          <div class="vital-rating" id="loadRating"></div>
                          <div class="vital-target">Target: &lt; 2.5s</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Charts Section -->
                  <div class="dashboard-charts">
                    <div class="chart-section">
                      <h3>
                        <i class="fas fa-chart-line"></i> Request Volume Over
                        Time
                      </h3>
                      <canvas id="dashboardVolumeChart"></canvas>
                    </div>

                    <div class="chart-row">
                      <div class="chart-section half">
                        <h3>
                          <i class="fas fa-chart-pie"></i> Status Distribution
                        </h3>
                        <canvas id="dashboardStatusChart"></canvas>
                      </div>

                      <div class="chart-section half">
                        <h3><i class="fas fa-chart-bar"></i> Top Domains</h3>
                        <canvas id="dashboardDomainsChart"></canvas>
                      </div>
                    </div>

                    <div class="chart-section">
                      <h3>
                        <i class="fas fa-chart-area"></i> Performance Trends
                      </h3>
                      <canvas id="dashboardPerformanceChart"></canvas>
                    </div>
                  </div>
                </div>
                <!-- End Overview Tab -->

                <!-- Requests Tab -->
                <div class="dashboard-tab-content" data-tab-content="requests">
                  <!-- Requests Table Section -->
                  <div class="chart-section">
                    <div
                      style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 12px;
                      "
                    >
                      <h3 style="margin: 0">
                        <i class="fas fa-list"></i> Requests Table
                      </h3>
                      <button id="dashboardExportHAR" class="btn-secondary">
                        <i class="fas fa-download"></i> Export HAR
                      </button>
                    </div>
                    <p
                      class="hint"
                      style="
                        font-size: 13px;
                        color: var(--text-secondary-color);
                        margin-bottom: 16px;
                      "
                    >
                      View detailed request information with search, pagination,
                      and cURL export capabilities.
                    </p>

                    <div
                      class="table-controls"
                      style="
                        display: flex;
                        gap: 12px;
                        margin-bottom: 16px;
                        flex-wrap: wrap;
                        justify-content: space-between;
                      "
                    >
                      <div
                        class="search-container"
                        style="flex: 1; max-width: 400px"
                      >
                        <i class="fas fa-search"></i>
                        <input
                          type="text"
                          id="dashboardSearchRequests"
                          placeholder="Search URLs, methods, status..."
                          class="search-input"
                        />
                      </div>
                      <select
                        id="dashboardRequestsPerPage"
                        class="filter-select"
                      >
                        <option value="10">10 per page</option>
                        <option value="25" selected>25 per page</option>
                        <option value="50">50 per page</option>
                        <option value="100">100 per page</option>
                      </select>
                    </div>

                    <div
                      class="requests-table-container"
                      style="overflow-x: auto"
                    >
                      <table
                        id="dashboardRequestsTable"
                        class="data-table"
                        style="width: 100%; border-collapse: collapse"
                      >
                        <thead>
                          <tr>
                            <th>Method</th>
                            <th>URL</th>
                            <th>Status</th>
                            <th>Type</th>
                            <th>Time</th>
                            <th>Size</th>
                            <th>Actions</th>
                          </tr>
                        </thead>
                        <tbody id="dashboardRequestsTableBody">
                          <tr class="no-data-row">
                            <td
                              colspan="7"
                              style="
                                text-align: center;
                                padding: 24px;
                                color: var(--text-secondary-color);
                              "
                            >
                              No requests available. Select filters and refresh
                              to load data.
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div
                      id="dashboardTablePagination"
                      class="table-pagination"
                      style="
                        margin-top: 16px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                      "
                    ></div>
                  </div>
                </div>
                <!-- End Requests Tab -->

                <!-- Performance Tab -->
                <div
                  class="dashboard-tab-content"
                  data-tab-content="performance"
                >
                  <p class="hint" style="margin-bottom: 16px">
                    <i class="fas fa-info-circle"></i> Track endpoint
                    performance, response times, and request trends over time.
                  </p>

                  <!-- Endpoint Performance Over Time -->
                  <div class="chart-section">
                    <div
                      style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 12px;
                      "
                    >
                      <h3 style="margin: 0">
                        <i class="fas fa-chart-line"></i> Endpoint Performance
                        Over Time
                      </h3>
                    </div>
                    <p
                      class="hint"
                      style="
                        font-size: 13px;
                        color: var(--text-secondary-color);
                        margin-bottom: 16px;
                      "
                    >
                      Track request types (fetch, xhr, script, etc.) or specific
                      API endpoints performance over time.
                    </p>

                    <div
                      class="history-controls"
                      style="
                        display: flex;
                        gap: 12px;
                        margin-bottom: 16px;
                        flex-wrap: wrap;
                      "
                    >
                      <div class="filter-group">
                        <label
                          ><i class="fas fa-filter"></i> Type Filter:</label
                        >
                        <select
                          id="dashboardEndpointTypeFilter"
                          class="filter-select"
                        >
                          <option value="">All Types</option>
                          <option value="fetch">Fetch</option>
                          <option value="xmlhttprequest">XHR/AJAX</option>
                          <option value="script">Script</option>
                          <option value="stylesheet">Stylesheet</option>
                          <option value="image">Image</option>
                          <option value="font">Font</option>
                          <option value="document">Document</option>
                          <option value="other">Other</option>
                        </select>
                      </div>

                      <div class="filter-group">
                        <label
                          ><i class="fas fa-link"></i> Endpoint Pattern:</label
                        >
                        <input
                          type="text"
                          id="dashboardEndpointPattern"
                          placeholder="e.g., /api/login, /users/:id"
                          class="modern-input"
                          style="min-width: 250px"
                        />
                      </div>

                      <div class="filter-group">
                        <label
                          ><i class="fas fa-calendar"></i> Time Bucket:</label
                        >
                        <select
                          id="dashboardHistoryTimeBucket"
                          class="filter-select"
                        >
                          <option value="hourly" selected>Hourly</option>
                          <option value="daily">Daily</option>
                        </select>
                      </div>

                      <button
                        id="dashboardLoadHistoryBtn"
                        class="btn-primary"
                        style="padding: 8px 16px"
                      >
                        <i class="fas fa-sync-alt"></i> Load History
                      </button>
                    </div>

                    <div
                      id="dashboardPerformanceHistoryChart"
                      style="min-height: 300px; position: relative"
                    >
                      <canvas id="dashboardHistoryChartCanvas"></canvas>
                    </div>
                  </div>
                </div>
                <!-- End Performance Tab -->

                <!-- Resources Tab -->
                <div class="dashboard-tab-content" data-tab-content="resources">
                  <!-- Resource Breakdown Section -->
                  <div class="chart-section">
                    <h3>
                      <i class="fas fa-database"></i> Resource Size Breakdown
                    </h3>
                    <p
                      class="hint"
                      style="
                        font-size: 13px;
                        color: var(--text-secondary-color);
                        margin-bottom: 16px;
                      "
                    >
                      Analyze resource types, sizes, and potential compression
                      savings for the selected domain.
                    </p>

                    <div
                      style="
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 24px;
                        margin-bottom: 24px;
                      "
                    >
                      <div>
                        <h4 style="margin-bottom: 12px">
                          <i class="fas fa-chart-pie"></i> Size Distribution
                        </h4>
                        <div
                          id="dashboardResourceChartContainer"
                          style="min-height: 300px; position: relative"
                        >
                          <canvas id="dashboardResourcePieChart"></canvas>
                        </div>
                      </div>
                      <div>
                        <h4 style="margin-bottom: 12px">
                          <i class="fas fa-compress"></i> Compression Analysis
                        </h4>
                        <div
                          id="dashboardCompressionStats"
                          style="
                            padding: 16px;
                            background: var(--surface-color);
                            border-radius: 8px;
                          "
                        >
                          <p class="no-data">
                            No data available. Refresh Dashboard to load
                            resource stats.
                          </p>
                        </div>
                      </div>
                    </div>

                    <div
                      id="dashboardResourcesTable"
                      class="resources-table"
                    ></div>
                  </div>
                </div>
                <!-- End Resources Tab -->

                <!-- Errors Tab -->
                <div class="dashboard-tab-content" data-tab-content="errors">
                  <!-- Error Analysis Section -->
                  <div class="chart-section">
                    <h3><i class="fas fa-bug"></i> Error Analysis</h3>
                    <p
                      class="hint"
                      style="
                        font-size: 13px;
                        color: var(--text-secondary-color);
                        margin-bottom: 16px;
                      "
                    >
                      Analyze failed requests (4xx client errors and 5xx server
                      errors) for the selected domain.
                    </p>

                    <div
                      id="dashboardErrorCategories"
                      class="error-categories"
                      style="margin-bottom: 24px"
                    ></div>

                    <div
                      style="
                        display: grid;
                        grid-template-columns: 2fr 1fr;
                        gap: 24px;
                        margin-bottom: 24px;
                      "
                    >
                      <div>
                        <h4 style="margin-bottom: 12px">
                          <i class="fas fa-exclamation-triangle"></i> Failed
                          Requests
                        </h4>
                        <div
                          id="dashboardErrorsList"
                          class="errors-list"
                          style="max-height: 400px; overflow-y: auto"
                        >
                          <p class="no-data">
                            No errors found. Refresh Dashboard to load error
                            data.
                          </p>
                        </div>
                      </div>
                      <div>
                        <h4 style="margin-bottom: 12px">
                          <i class="fas fa-chart-bar"></i> Error Distribution
                        </h4>
                        <div style="min-height: 300px; position: relative">
                          <canvas id="dashboardErrorsChart"></canvas>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- End Errors Tab -->

                <!-- Analytics Tab -->
                <div class="dashboard-tab-content" data-tab-content="analytics">
                  <p class="hint" style="margin-bottom: 16px">
                    <i class="fas fa-info-circle"></i> Advanced analytics
                    including percentiles, anomalies, trends, and domain
                    comparisons.
                  </p>

                  <!-- Percentiles Analysis -->
                  <div class="analytics-section">
                    <h3>
                      <i class="fas fa-percentage"></i> Response Time
                      Percentiles
                    </h3>
                    <div
                      id="percentilesLoading"
                      class="loading-indicator"
                      style="display: none"
                    >
                      <i class="fas fa-spinner fa-spin"></i> Loading
                      percentiles...
                    </div>
                    <div class="percentiles-grid" id="percentilesGrid">
                      <div class="percentile-card">
                        <div class="percentile-label">P50 (Median)</div>
                        <div class="percentile-value" id="p50Value">-</div>
                        <div class="percentile-desc">50% of requests</div>
                      </div>
                      <div class="percentile-card">
                        <div class="percentile-label">P75</div>
                        <div class="percentile-value" id="p75Value">-</div>
                        <div class="percentile-desc">75% of requests</div>
                      </div>
                      <div class="percentile-card">
                        <div class="percentile-label">P90</div>
                        <div class="percentile-value" id="p90Value">-</div>
                        <div class="percentile-desc">90% of requests</div>
                      </div>
                      <div class="percentile-card">
                        <div class="percentile-label">P95</div>
                        <div class="percentile-value" id="p95Value">-</div>
                        <div class="percentile-desc">95% of requests</div>
                      </div>
                      <div class="percentile-card">
                        <div class="percentile-label">P99</div>
                        <div class="percentile-value" id="p99Value">-</div>
                        <div class="percentile-desc">99% of requests</div>
                      </div>
                      <div class="percentile-card">
                        <div class="percentile-label">Max</div>
                        <div class="percentile-value" id="maxValue">-</div>
                        <div class="percentile-desc">Slowest request</div>
                      </div>
                    </div>
                  </div>

                  <!-- Features removed: Anomaly Detection, Trend Analysis, Heatmap, Domain Comparison, Performance Insights -->
                  <!-- These don't provide actionable value for developers actively building/testing applications -->
                </div>
                <!-- End Analytics Tab -->
              </div>
              <!-- End Dashboard Tabs -->
            </div>
          </section>

          <!-- Alerts Tab -->
          <section id="alerts" class="tab-content">
            <div class="alerts-container">
              <h2><i class="fas fa-bell"></i> Alerts & Notifications</h2>

              <!-- Alert Rules -->
              <div class="alerts-section">
                <div class="section-header">
                  <h3><i class="fas fa-cog"></i> Alert Rules</h3>
                  <button id="addAlertRuleBtn" class="btn-primary">
                    <i class="fas fa-plus"></i> Add Rule
                  </button>
                </div>
                <div
                  id="alertRulesLoading"
                  class="loading-indicator"
                  style="display: none"
                >
                  <i class="fas fa-spinner fa-spin"></i> Loading alert rules...
                </div>
                <div id="alertRulesList" class="alert-rules-list">
                  <p class="placeholder">
                    No alert rules configured. Click "Add Rule" to create your
                    first alert.
                  </p>
                </div>
              </div>

              <!-- Alert History -->
              <div class="alerts-section">
                <div class="section-header">
                  <h3><i class="fas fa-history"></i> Alert History</h3>
                  <button id="refreshAlertHistoryBtn" class="btn-secondary">
                    <i class="fas fa-sync-alt"></i> Refresh
                  </button>
                </div>
                <div
                  id="alertHistoryLoading"
                  class="loading-indicator"
                  style="display: none"
                >
                  <i class="fas fa-spinner fa-spin"></i> Loading alert
                  history...
                </div>
                <div id="alertHistoryList" class="alert-history-list">
                  <p class="placeholder">No alerts have been triggered</p>
                </div>
              </div>

              <!-- Alert Configuration Modal -->
              <div id="alertRuleModal" class="modal" style="display: none">
                <div class="modal-content">
                  <div class="modal-header">
                    <h3><i class="fas fa-bell"></i> Configure Alert Rule</h3>
                    <button class="modal-close">&times;</button>
                  </div>
                  <div class="modal-body">
                    <div class="form-group">
                      <label for="alertName">Alert Name:</label>
                      <input
                        type="text"
                        id="alertName"
                        placeholder="e.g., High Response Time Alert"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="alertMetric">Metric:</label>
                      <select id="alertMetric">
                        <option value="avgDuration">
                          Average Response Time
                        </option>
                        <option value="errorRate">Error Rate (%)</option>
                        <option value="requestCount">Request Count</option>
                        <option value="maxDuration">Max Response Time</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="alertCondition">Condition:</label>
                      <select id="alertCondition">
                        <option value="gt">Greater Than</option>
                        <option value="lt">Less Than</option>
                        <option value="eq">Equal To</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="alertThreshold">Threshold:</label>
                      <input
                        type="number"
                        id="alertThreshold"
                        placeholder="e.g., 1000"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="alertDomain">Domain (Optional):</label>
                      <select id="alertDomain">
                        <option value="">All Domains</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label>
                        <input type="checkbox" id="alertEnabled" checked />
                        Enable this alert
                      </label>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button id="saveAlertRuleBtn" class="btn-primary">
                      <i class="fas fa-save"></i> Save Rule
                    </button>
                    <button id="cancelAlertRuleBtn" class="btn-secondary">
                      Cancel
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- General Settings Tab -->
          <section id="general" class="tab-content">
            <div class="options-container">
              <!-- Capture Settings -->
              <div class="option-section">
                <h2><i class="fas fa-power-off"></i> Capture Settings</h2>
                <div class="option-row">
                  <div class="toggle-switch-row">
                    <label class="toggle-label">
                      <span class="toggle-text">Enable Request Capture</span>
                      <input
                        type="checkbox"
                        id="captureEnabled"
                        class="toggle-input"
                      />
                      <span class="toggle-slider"></span>
                    </label>
                    <span id="captureStatus" class="status-indicator"></span>
                  </div>
                </div>

                <div class="option-row">
                  <label for="maxStoredRequests" class="input-label">
                    <i class="fas fa-database"></i> Maximum Stored Requests
                  </label>
                  <div class="input-with-unit">
                    <input
                      type="number"
                      id="maxStoredRequests"
                      min="100"
                      max="100000"
                      step="100"
                      class="modern-input"
                    />
                    <span class="input-unit">requests</span>
                  </div>
                  <div class="storage-usage">
                    <span id="currentStorageCount">0</span> /
                    <span id="maxStorageDisplay">10,000</span> requests
                    <div class="usage-bar">
                      <div
                        id="usageBarFill"
                        class="usage-bar-fill"
                        style="width: 0%"
                      ></div>
                    </div>
                  </div>
                </div>

                <div class="option-row">
                  <label class="input-label">Quick Presets</label>
                  <div class="preset-buttons">
                    <button class="preset-btn" data-value="1000">
                      <i class="fas fa-feather"></i> Light (1K)
                    </button>
                    <button class="preset-btn" data-value="10000">
                      <i class="fas fa-balance-scale"></i> Medium (10K)
                    </button>
                    <button class="preset-btn" data-value="50000">
                      <i class="fas fa-weight-hanging"></i> Heavy (50K)
                    </button>
                    <button class="preset-btn" data-value="100000">
                      <i class="fas fa-rocket"></i> Max (100K)
                    </button>
                  </div>
                </div>
              </div>

              <!-- Capture Filters -->
              <div class="option-section">
                <h2><i class="fas fa-filter"></i> Capture Filters</h2>
                <p class="description">
                  Configure what requests to capture. Changes are automatically
                  applied to all visualizations.
                </p>

                <div class="option-row">
                  <div class="toggle-switch-row">
                    <label class="toggle-label">
                      <span class="toggle-text"
                        >Auto-apply filters to all visualizations</span
                      >
                      <input
                        type="checkbox"
                        id="autoApplyFilters"
                        checked
                        class="toggle-input"
                      />
                      <span class="toggle-slider"></span>
                    </label>
                    <span
                      class="status-indicator active"
                      id="filterApplyStatus"
                    ></span>
                  </div>
                </div>

                <h3><i class="fas fa-network-wired"></i> Request Types</h3>
                <div class="option-row">
                  <div class="checkbox-grid">
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="captureType"
                        value="xmlhttprequest"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-code"></i>
                        <span>XHR</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input type="checkbox" name="captureType" value="fetch" />
                      <span class="checkbox-card-content">
                        <i class="fas fa-download"></i>
                        <span>Fetch</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="captureType"
                        value="script"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-file-code"></i>
                        <span>Script</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="captureType"
                        value="stylesheet"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-palette"></i>
                        <span>Stylesheet</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input type="checkbox" name="captureType" value="image" />
                      <span class="checkbox-card-content">
                        <i class="fas fa-image"></i>
                        <span>Image</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input type="checkbox" name="captureType" value="font" />
                      <span class="checkbox-card-content">
                        <i class="fas fa-font"></i>
                        <span>Font</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input type="checkbox" name="captureType" value="other" />
                      <span class="checkbox-card-content">
                        <i class="fas fa-ellipsis-h"></i>
                        <span>Other</span>
                      </span>
                    </label>
                  </div>
                </div>

                <h3><i class="fas fa-globe"></i> Domain Filters</h3>
                <div class="option-row">
                  <label for="includeDomains" class="input-label">
                    <i class="fas fa-check-circle"></i> Include Domains
                  </label>
                  <input
                    type="text"
                    id="includeDomains"
                    class="modern-input"
                    placeholder="github.com, api.github.com (comma separated)"
                  />
                  <span id="includeDomainsError" class="error-message"></span>
                  <p class="help-text">
                    <i class="fas fa-info-circle"></i> Wildcard support:
                    *.example.com matches all subdomains. Leave empty to capture
                    all domains.
                  </p>
                </div>

                <div class="option-row">
                  <label for="excludeDomains" class="input-label">
                    <i class="fas fa-times-circle"></i> Exclude Domains
                  </label>
                  <input
                    type="text"
                    id="excludeDomains"
                    class="modern-input"
                    placeholder="Browser pages excluded by default"
                  />
                  <span id="excludeDomainsError" class="error-message"></span>
                  <p class="help-text">
                    <i class="fas fa-info-circle"></i> Browser internal pages
                    (chrome://, edge://, about:) are automatically excluded.
                  </p>
                </div>

                <h3><i class="fas fa-cogs"></i> Advanced Filters</h3>
                <div class="option-row">
                  <label for="urlPattern" class="input-label">
                    <i class="fas fa-search"></i> URL Pattern (Regex)
                  </label>
                  <input
                    type="text"
                    id="urlPattern"
                    class="modern-input"
                    placeholder="/api/.*|/graphql.*"
                  />
                  <span id="urlPatternError" class="error-message"></span>
                  <p class="help-text">
                    <i class="fas fa-info-circle"></i> JavaScript regex pattern
                    to match request URLs
                  </p>
                </div>
              </div>

              <!-- Visualization Settings -->
              <div class="option-section">
                <h2><i class="fas fa-chart-bar"></i> Visualization</h2>
                <div class="option-row">
                  <div class="toggle-switch-row">
                    <label class="toggle-label">
                      <span class="toggle-text">Enable Plots</span>
                      <input
                        type="checkbox"
                        id="plotEnabled"
                        class="toggle-input"
                      />
                      <span class="toggle-slider"></span>
                    </label>
                  </div>
                </div>

                <div class="option-row">
                  <label class="input-label">Plot Types</label>
                  <div class="checkbox-grid">
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="plotType"
                        value="responseTime"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-clock"></i>
                        <span>Response Time</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="plotType"
                        value="statusCodes"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-info-circle"></i>
                        <span>Status Codes</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input type="checkbox" name="plotType" value="domains" />
                      <span class="checkbox-card-content">
                        <i class="fas fa-server"></i>
                        <span>Domains</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="plotType"
                        value="requestTypes"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-list"></i>
                        <span>Request Types</span>
                      </span>
                    </label>
                    <label class="checkbox-card">
                      <input
                        type="checkbox"
                        name="plotType"
                        value="timeDistribution"
                      />
                      <span class="checkbox-card-content">
                        <i class="fas fa-chart-area"></i>
                        <span>Time Distribution</span>
                      </span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- Site Tracking Configuration -->
              <div class="option-section">
                <h2>
                  <i class="fas fa-globe-americas"></i> Site Tracking
                  Configuration
                </h2>
                <p class="description">
                  Configure specific sites to track for analysis. Content
                  scripts will filter data based on these sites.
                </p>

                <div class="option-row">
                  <label for="trackingSites" class="input-label">
                    <i class="fas fa-list"></i> Sites to Track
                  </label>
                  <textarea
                    id="trackingSites"
                    rows="6"
                    class="modern-textarea"
                    placeholder="Enter one site pattern per line, e.g.:
https://example.com
https://*.github.com
/api\.example\.com/ (regex)
*.mysite.com
example.org/api/*"
                  ></textarea>
                  <p class="help-text">
                    <i class="fas fa-info-circle"></i>
                    <strong>Supported formats:</strong><br />
                     Full URLs: https://example.com<br />
                     Wildcards: *.example.com or example.com/*<br />
                     Regex patterns: /pattern/ (between slashes)<br />
                     Mixed: https://*.api.example.com/v1/*
                  </p>
                </div>

                <div class="option-row">
                  <button id="validateSitesBtn" class="secondary-btn">
                    <i class="fas fa-check-circle"></i> Validate Patterns
                  </button>
                  <button id="addCurrentSiteBtn" class="secondary-btn">
                    <i class="fas fa-plus"></i> Add Current Site
                  </button>
                  <span id="sitesValidationResult" class="help-text"></span>
                </div>

                <div class="option-row">
                  <div class="toggle-switch-row">
                    <label class="toggle-label">
                      <span class="toggle-text"
                        >Track ONLY configured sites (if unchecked, tracks all
                        sites)</span
                      >
                      <input
                        type="checkbox"
                        id="trackOnlyConfiguredSites"
                        checked
                        class="toggle-input"
                      />
                      <span class="toggle-slider"></span>
                    </label>
                  </div>
                </div>

                <div class="tracked-sites-box">
                  <h4>
                    <i class="fas fa-info-circle"></i> Currently Tracked Sites
                  </h4>
                  <div id="trackedSitesList">
                    <p class="placeholder">
                      No sites configured. Add sites above to start tracking
                      specific URLs.
                    </p>
                  </div>
                </div>

                <div class="option-row">
                  <label class="input-label">Quick Site Presets</label>
                  <div class="preset-buttons">
                    <button class="site-preset-btn" data-preset="current">
                      <i class="fas fa-window-maximize"></i> Add Current Tab
                    </button>
                    <button class="site-preset-btn" data-preset="popular">
                      <i class="fas fa-fire"></i> Popular APIs
                    </button>
                    <button class="site-preset-btn" data-preset="clear">
                      <i class="fas fa-trash"></i> Clear All
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Export Settings Tab -->
          <section id="export" class="tab-content">
            <div class="options-container">
              <div class="option-section">
                <h2>Manual Export</h2>
                <div class="option-row">
                  <button id="exportNowBtn" class="btn-primary">
                    <i class="fas fa-download"></i> Export Now
                  </button>
                  <select id="manualExportFormat">
                    <option value="json">JSON</option>
                    <option value="csv">CSV</option>
                    <option value="sqlite">SQLite</option>
                  </select>
                  <p class="description">
                    Immediately export all collected data
                  </p>
                </div>
                <div class="option-row">
                  <label>Last Export:</label>
                  <span id="lastExportTime">Never</span>
                </div>
              </div>

              <div class="option-section">
                <h2>Auto Export</h2>
                <div class="option-row">
                  <label>
                    <input type="checkbox" id="autoExport" />
                    Enable Auto Export
                  </label>
                  <span id="autoExportStatus" class="status-indicator"></span>
                </div>
                <div class="option-row">
                  <label for="exportFormat">Export Format:</label>
                  <select id="exportFormat">
                    <option value="json">JSON</option>
                    <option value="csv">CSV</option>
                    <option value="sqlite">SQLite</option>
                  </select>
                </div>
                <div class="option-row">
                  <label for="exportInterval">Export Interval (minutes):</label>
                  <input
                    type="number"
                    id="exportInterval"
                    min="5"
                    max="1440"
                    step="5"
                  />
                  <span class="help-text"
                    >Next export in: <span id="nextExportTime">--</span></span
                  >
                </div>
                <div class="option-row">
                  <label for="exportPath">Export Directory (optional):</label>
                  <input
                    type="text"
                    id="exportPath"
                    placeholder="Default downloads directory"
                  />
                </div>
              </div>
            </div>
          </section>

          <!-- Data Retention Tab -->
          <section id="retention" class="tab-content">
            <div class="options-container">
              <!-- Settings Profiles Section -->
              <div class="option-section">
                <h2><i class="fas fa-layer-group"></i> Settings Profiles</h2>
                <p class="section-description">
                  Save and load preset configurations for different environments
                  (Development, Production, Testing, etc.)
                </p>

                <div class="profiles-container">
                  <div class="profile-actions">
                    <button id="saveProfile" class="btn-primary">
                      <i class="fas fa-save"></i> Save Current as Profile
                    </button>
                    <button id="manageProfiles" class="btn-secondary">
                      <i class="fas fa-cog"></i> Manage Profiles
                    </button>
                  </div>

                  <div class="profiles-grid">
                    <h4>Quick Load Profiles</h4>
                    <div id="profilesList" class="profiles-list">
                      <!-- Populated dynamically -->
                      <div class="empty-state">
                        <i class="fas fa-layer-group fa-3x"></i>
                        <p>No profiles saved yet</p>
                        <p class="help-text">
                          Click "Save Current as Profile" to create your first
                          profile
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="option-section">
                <h2>Data Management & Operations</h2>

                <div class="info-box">
                  <h4>
                    <i class="fas fa-database"></i> Current Database Status
                  </h4>
                  <div class="db-status-grid">
                    <div class="db-stat">
                      <span class="label">Total Size:</span>
                      <span id="currentDbSize" class="value"
                        >Calculating...</span
                      >
                    </div>
                    <div class="db-stat">
                      <span class="label">Total Records:</span>
                      <span id="currentDbRecords" class="value">0</span>
                    </div>
                    <div class="db-stat">
                      <span class="label">Oldest Record:</span>
                      <span id="oldestRecord" class="value">N/A</span>
                    </div>
                  </div>
                </div>

                <h3><i class="fas fa-clock"></i> Cleanup Preview</h3>
                <div class="option-row">
                  <label for="cleanupAge"
                    >Delete records older than (days):</label
                  >
                  <input
                    type="number"
                    id="cleanupAge"
                    min="1"
                    max="365"
                    value="30"
                  />
                </div>

                <div class="option-row">
                  <button id="previewCleanupBtn" class="secondary-btn">
                    <i class="fas fa-eye"></i> Preview Cleanup
                  </button>
                  <div
                    id="cleanupPreview"
                    class="preview-box"
                    style="display: none"
                  >
                    <h4>Cleanup Preview:</h4>
                    <p>
                      Records to delete:
                      <strong id="previewRecordsCount">0</strong>
                    </p>
                    <p>
                      Estimated size freed:
                      <strong id="previewSizeFreed">0 MB</strong>
                    </p>
                    <p>
                      Records remaining:
                      <strong id="previewRecordsRemaining">0</strong>
                    </p>
                  </div>
                </div>

                <div class="option-row">
                  <button id="createBackupBtn" class="btn-primary">
                    <i class="fas fa-save"></i> Create Manual Backup
                  </button>
                  <span id="lastBackupTime" class="help-text"
                    >Last backup: Never</span
                  >
                </div>

                <h3><i class="fas fa-exchange-alt"></i> Database Operations</h3>
                <p class="description" style="margin-bottom: 16px">
                  Export, import, and manage your database.
                  <strong>Import replaces your entire database</strong> - a
                  backup is created automatically.
                </p>

                <div class="operations-grid">
                  <!-- Export Database Card -->
                  <div class="operation-card">
                    <h4><i class="fas fa-download"></i> Export Database</h4>
                    <p>
                      Download your entire database as a SQLite file. Use this
                      for backups or transferring data.
                    </p>
                    <button id="exportRawDbBtn" class="btn-primary">
                      <i class="fas fa-download"></i> Export SQLite Database
                    </button>
                  </div>

                  <!-- Import Database Card -->
                  <div class="operation-card warning">
                    <h4><i class="fas fa-upload"></i> Import Database</h4>
                    <p>
                      <strong> Replaces current database completely.</strong
                      ><br />
                      Automatic backup created first. Choose a .sqlite or .db
                      file.
                    </p>
                    <input
                      type="file"
                      id="importDbFile"
                      accept=".sqlite,.db"
                      style="display: none"
                    />
                    <button id="importDbBtn" class="warning-btn">
                      <i class="fas fa-upload"></i> Import SQLite Database
                    </button>
                  </div>

                  <!-- Vacuum Database Card -->
                  <div class="operation-card">
                    <h4><i class="fas fa-compress-alt"></i> Vacuum Database</h4>
                    <p>
                      Compact database to reclaim disk space. Recommended after
                      cleanup or deletions.
                    </p>
                    <button id="vacuumDatabaseBtn" class="secondary-btn">
                      <i class="fas fa-compress-alt"></i> Vacuum Database
                    </button>
                  </div>

                  <!-- Clear Cache Card -->
                  <div class="operation-card">
                    <h4><i class="fas fa-eraser"></i> Clear Cache</h4>
                    <p>
                      Clear extension cache and force reload. Less destructive
                      than reset.
                    </p>
                    <button id="clearCacheBtn" class="secondary-btn">
                      <i class="fas fa-eraser"></i> Clear Extension Cache
                    </button>
                  </div>
                </div>

                <div class="danger-zone">
                  <h3>
                    <i class="fas fa-exclamation-triangle"></i> Danger Zone
                  </h3>
                  <p class="warning-text">
                    <strong> Warning:</strong> These operations permanently
                    delete data. Always create a backup before proceeding!
                  </p>

                  <div class="operations-grid">
                    <!-- Execute Cleanup Card -->
                    <div class="operation-card danger">
                      <h4><i class="fas fa-broom"></i> Delete Old Records</h4>
                      <p>
                        <strong>Removes records older than X days</strong> (you
                        choose: 30, 60, 90 days).<br />
                        Recent data is kept. Must preview first to see what will
                        be deleted.
                      </p>
                      <button
                        id="executeCleanupBtn"
                        class="danger-btn"
                        disabled
                      >
                        <i class="fas fa-broom"></i> Execute Cleanup
                      </button>
                    </div>

                    <!-- Reset Database Card -->
                    <div class="operation-card danger">
                      <h4><i class="fas fa-trash-alt"></i> Complete Reset</h4>
                      <p>
                        <strong>Deletes EVERYTHING</strong> - all requests, all
                        analytics, all history.<br />
                        Like a fresh install. Cannot be undone! Double
                        confirmation required.
                      </p>
                      <button id="resetDatabaseBtn" class="danger-btn">
                        <i class="fas fa-trash-alt"></i> Reset Database
                      </button>
                    </div>
                  </div>
                </div>

                <h3><i class="fas fa-history"></i> Cleanup History</h3>
                <div id="cleanupHistory" class="history-box">
                  <p class="placeholder">No cleanup history available</p>
                </div>
              </div>
            </div>
          </section>

          <!-- Security Settings Tab -->
          <section id="security" class="tab-content">
            <div class="options-container">
              <div class="option-section">
                <h2>Settings Import/Export</h2>

                <div class="warning-box">
                  <i class="fas fa-exclamation-triangle"></i>
                  <strong>Warning:</strong> Importing will overwrite your
                  current settings. A backup will be created automatically.
                </div>

                <h3><i class="fas fa-file-export"></i> Export Settings</h3>
                <div class="option-row">
                  <button id="exportSettingsBtn" class="btn-primary">
                    <i class="fas fa-download"></i> Export Settings
                  </button>
                  <p class="description">
                    Export all settings to a JSON file for backup or transfer
                  </p>
                </div>

                <div class="option-row">
                  <label>
                    <input type="checkbox" id="encryptExport" />
                    <span>Encrypt with password (coming soon)</span>
                  </label>
                </div>

                <h3><i class="fas fa-file-import"></i> Import Settings</h3>
                <div class="option-row">
                  <input
                    type="file"
                    id="importSettingsFile"
                    accept=".json"
                    style="display: none"
                  />
                  <button id="importSettingsBtn" class="btn-primary">
                    <i class="fas fa-upload"></i> Import Settings
                  </button>
                  <p class="description">
                    Import settings from a previously exported file
                  </p>
                </div>

                <div class="option-row">
                  <label>
                    <input type="checkbox" id="selectiveImport" />
                    <span>Selective Import (choose specific sections)</span>
                  </label>
                </div>

                <div
                  id="selectiveImportOptions"
                  class="selective-import-box import-section-selector"
                  style="display: none"
                >
                  <h4>Select sections to import:</h4>
                  <div class="import-sections-grid">
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="general"
                        checked
                      />
                      General Settings
                    </label>
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="filters"
                        checked
                      />
                      Filters
                    </label>
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="monitoring"
                        checked
                      />
                      Monitoring
                    </label>
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="export"
                        checked
                      />
                      Export Settings
                    </label>
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="themes"
                        checked
                      />
                      Themes
                    </label>
                    <label class="checkbox-label">
                      <input
                        type="checkbox"
                        name="importSection"
                        value="retention"
                        checked
                      />
                      Data Retention
                    </label>
                  </div>
                </div>

                <h3>
                  <i class="fas fa-info-circle"></i> Import Safety Features
                </h3>
                <ul class="safety-features-list">
                  <li> Automatic backup created before import</li>
                  <li> Settings validation before applying</li>
                  <li> Selective import to preserve specific settings</li>
                  <li> Version compatibility check (coming soon)</li>
                  <li> Password encryption support (coming soon)</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Themes Settings Tab -->
          <section id="themes" class="tab-content">
            <div class="options-container">
              <div class="option-section">
                <h2>Theme Settings</h2>
                <div class="option-row">
                  <label for="currentTheme">Current Theme:</label>
                  <select id="currentTheme">
                    <option value="system">System Preference</option>
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="highContrast">High Contrast</option>
                    <option value="blue">Blue</option>
                  </select>
                </div>

                <h3>Available Themes</h3>
                <div class="themes-container">
                  <!-- Theme cards will be added dynamically -->
                </div>

                <div class="option-row actions">
                  <button id="saveThemeBtn" class="primary-btn">
                    Save Changes
                  </button>
                  <button id="resetThemeBtn" class="secondary-btn">
                    Reset to Default
                  </button>
                </div>
              </div>
            </div>
          </section>

          <!-- Advanced Tab -->
          <section id="advanced" class="tab-content">
            <div class="options-container">
              <div class="option-section">
                <h2>Advanced Features</h2>
                <p class="description">
                  Advanced debugging and database management tools
                </p>

                <h3><i class="fas fa-database"></i> Database Management</h3>

                <div class="option-row">
                  <label>Database Location:</label>
                  <code>IndexedDB: ura_medallion_db</code>
                </div>

                <div class="option-row">
                  <label>Database Size:</label>
                  <span id="advancedDbSize">Calculating...</span>
                </div>

                <div class="option-row">
                  <label>Total Records:</label>
                  <div class="db-layer-stats">
                    <div class="stat-item">
                      <span class="stat-label">Bronze:</span>
                      <span id="advancedBronzeCount">0</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Silver:</span>
                      <span id="advancedSilverCount">0</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Gold:</span>
                      <span id="advancedGoldCount">0</span>
                    </div>
                  </div>
                </div>

                <h3><i class="fas fa-table"></i> Database Tables</h3>
                <div class="tables-section">
                  <div class="option-row">
                    <label>Available Tables:</label>
                    <div id="tablesListContainer" class="tables-list">
                      <p class="placeholder">Loading tables...</p>
                    </div>
                  </div>
                  <div class="option-row">
                    <label>Table Preview (5 records):</label>
                    <div id="tablePreviewContainer" class="table-preview">
                      <p class="placeholder">
                        Select a table above to preview records
                      </p>
                    </div>
                  </div>
                </div>

                <h3><i class="fas fa-search"></i> Direct Database Query</h3>
                <div class="query-section">
                  <div class="option-row">
                    <label for="advancedQuery">SQL Query:</label>
                    <textarea
                      id="advancedQuery"
                      rows="5"
                      placeholder="SELECT * FROM bronze_requests LIMIT 10"
                    ></textarea>
                  </div>
                  <div class="option-row">
                    <button id="executeQueryBtn" class="primary-btn">
                      <i class="fas fa-play"></i> Execute Query
                    </button>
                    <button id="clearQueryBtn" class="secondary-btn">
                      <i class="fas fa-eraser"></i> Clear
                    </button>
                  </div>
                  <div class="option-row">
                    <label>Query Result:</label>
                    <div id="queryResult" class="query-result">
                      <p class="placeholder">
                        Execute a query to see results...
                      </p>
                    </div>
                  </div>
                </div>

                <h3><i class="fas fa-history"></i> Query History</h3>
                <div class="query-history-section">
                  <div class="option-row">
                    <div id="queryHistoryContainer" class="query-history">
                      <p class="placeholder">
                        No query history yet. Execute queries to see them here.
                      </p>
                    </div>
                  </div>
                  <div class="option-row">
                    <button id="clearHistoryBtn" class="secondary-btn">
                      <i class="fas fa-trash"></i> Clear History
                    </button>
                  </div>
                </div>

                <h3><i class="fas fa-tools"></i> Debug Tools</h3>
                <div class="debug-actions">
                  <div class="option-row">
                    <button id="inspectSchemaBtn" class="secondary-btn">
                      <i class="fas fa-table"></i> Inspect Database Schema
                    </button>
                    <p class="description">
                      View all tables and their structures
                    </p>
                  </div>
                  <div class="option-row">
                    <button id="viewLogsBtn" class="secondary-btn">
                      <i class="fas fa-file-alt"></i> View Extension Logs
                    </button>
                    <p class="description">Open browser console to view logs</p>
                  </div>
                  <div class="option-row">
                    <button id="testConnectionBtn" class="secondary-btn">
                      <i class="fas fa-plug"></i> Test Background Connection
                    </button>
                    <p class="description">
                      Verify connection to background script
                    </p>
                  </div>
                  <div class="option-row">
                    <button id="forceProcessBtn" class="warning-btn">
                      <i class="fas fa-sync"></i> Force Data Processing
                    </button>
                    <p class="description">
                      Manually trigger BronzeSilverGold processing
                    </p>
                  </div>
                </div>

                <div class="info-box" style="margin-top: 20px">
                  <h4>
                    <i class="fas fa-info-circle"></i> Database Import/Export
                  </h4>
                  <p
                    style="
                      margin: 0;
                      font-size: 14px;
                      color: var(--text-secondary);
                    "
                  >
                    Database import and export features have been moved to the
                    <strong>Data Management</strong> tab for better organization
                    and safety.
                  </p>
                </div>
              </div>
            </div>
          </section>
        </main>
      </div>
    </div>

    <div id="notification" class="notification"></div>

    <!-- Settings Import Preview Modal -->
    <div id="importPreviewModal" class="modal" style="display: none">
      <div class="modal-content" style="max-width: 900px">
        <div class="modal-header">
          <h3><i class="fas fa-search"></i> Import Preview</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Validation Status -->
          <div id="importValidationStatus" class="validation-status">
            <div class="validation-item">
              <i class="fas fa-spinner fa-spin"></i>
              <span>Validating settings...</span>
            </div>
          </div>

          <!-- Summary Stats -->
          <div id="importSummary" class="import-summary" style="display: none">
            <div class="summary-stats">
              <div class="stat-card">
                <div class="stat-label">Sections</div>
                <div class="stat-value" id="previewSectionsCount">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Changes</div>
                <div class="stat-value" id="previewChangesCount">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Validation</div>
                <div class="stat-value" id="previewValidation">
                  <i class="fas fa-check-circle text-success"></i> Valid
                </div>
              </div>
            </div>
          </div>

          <!-- Errors Display -->
          <div id="importErrors" class="import-errors" style="display: none">
            <h4>
              <i class="fas fa-exclamation-triangle"></i> Validation Errors
            </h4>
            <ul id="importErrorsList"></ul>
          </div>

          <!-- Warnings Display -->
          <div
            id="importWarnings"
            class="import-warnings"
            style="display: none"
          >
            <h4><i class="fas fa-exclamation-circle"></i> Warnings</h4>
            <ul id="importWarningsList"></ul>
          </div>

          <!-- Changes Preview -->
          <div id="importChanges" class="import-changes" style="display: none">
            <h4><i class="fas fa-exchange-alt"></i> Changes Preview</h4>
            <div class="changes-table-container">
              <table class="changes-table">
                <thead>
                  <tr>
                    <th>Section</th>
                    <th>Setting</th>
                    <th>Current Value</th>
                    <th>New Value</th>
                  </tr>
                </thead>
                <tbody id="importChangesBody">
                  <!-- Populated dynamically -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- No Changes Message -->
          <div id="importNoChanges" class="info-message" style="display: none">
            <i class="fas fa-info-circle"></i>
            <p>
              No changes detected. The imported settings are identical to your
              current configuration.
            </p>
          </div>
        </div>
        <div class="modal-footer">
          <button id="applyImportBtn" class="btn-primary" disabled>
            <i class="fas fa-check"></i> Apply Changes
          </button>
          <button id="cancelImportBtn" class="btn-secondary">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Profile Save Modal -->
    <div id="saveProfileModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-save"></i> Save Settings Profile</h3>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="profileName">
              <i class="fas fa-tag"></i> Profile Name:
            </label>
            <input
              type="text"
              id="profileName"
              placeholder="e.g., Development, Production, Testing"
              required
            />
          </div>
          <div class="form-group">
            <label for="profileDescription">
              <i class="fas fa-comment"></i> Description (optional):
            </label>
            <textarea
              id="profileDescription"
              rows="3"
              placeholder="Describe when to use this profile..."
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button id="confirmSaveProfile" class="btn-primary">
            <i class="fas fa-save"></i> Save Profile
          </button>
          <button id="cancelSaveProfile" class="btn-secondary">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Profile Management Modal -->
    <div id="manageProfilesModal" class="modal" style="display: none">
      <div class="modal-content" style="max-width: 800px">
        <div class="modal-header">
          <h3><i class="fas fa-cog"></i> Manage Profiles</h3>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <div id="manageProfilesList" class="manage-profiles-list">
            <!-- Populated dynamically -->
          </div>
        </div>
        <div class="modal-footer">
          <button id="closeManageProfiles" class="btn-secondary">
            <i class="fas fa-times"></i> Close
          </button>
        </div>
      </div>
    </div>

    <!-- Export Preview Modal -->
    <div id="exportPreviewModal" class="modal" style="display: none">
      <div class="modal-content" style="max-width: 900px">
        <div class="modal-header">
          <h3><i class="fas fa-download"></i> Export Preview</h3>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <!-- Summary Stats -->
          <div class="export-summary">
            <div class="summary-stats">
              <div class="stat-card">
                <div class="stat-label">Sections</div>
                <div class="stat-value" id="exportSectionsCount">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Settings</div>
                <div class="stat-value" id="exportSettingsCount">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">File Size</div>
                <div class="stat-value" id="exportFileSize">0 KB</div>
              </div>
            </div>
          </div>

          <!-- Sections List -->
          <div class="export-sections">
            <h4><i class="fas fa-list"></i> Sections to Export</h4>
            <div id="exportSectionsList" class="sections-list">
              <!-- Populated dynamically -->
            </div>
          </div>

          <!-- Preview Content -->
          <div class="export-preview">
            <h4><i class="fas fa-code"></i> Preview (first 50 lines)</h4>
            <pre id="exportPreviewContent" class="preview-content"></pre>
          </div>
        </div>
        <div class="modal-footer">
          <button id="confirmExport" class="btn-primary">
            <i class="fas fa-download"></i> Download
          </button>
          <button id="cancelExport" class="btn-secondary">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Dashboard Filter Modal -->
    <div id="dashboardFilterModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-filter"></i> Dashboard Filters</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="dashboardModalDomainFilter">
              <i class="fas fa-globe"></i> Domain:
            </label>
            <select id="dashboardModalDomainFilter" style="width: 100%">
              <option value="all">All Domains</option>
            </select>
          </div>
          <div class="form-group">
            <label for="dashboardModalPageFilter">
              <i class="fas fa-file"></i> Page:
            </label>
            <select id="dashboardModalPageFilter" style="width: 100%">
              <option value="">All Pages (Aggregated)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="dashboardModalRequestTypeFilter">
              <i class="fas fa-filter"></i> Type:
            </label>
            <select id="dashboardModalRequestTypeFilter" style="width: 100%">
              <option value="">All Types</option>
              <option value="xmlhttprequest">XHR/API</option>
              <option value="fetch">Fetch</option>
              <option value="script">Scripts</option>
              <option value="stylesheet">Stylesheets</option>
              <option value="image">Images</option>
              <option value="font">Fonts</option>
              <option value="document">Documents</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="applyDashboardFiltersBtn" class="btn-primary">
            <i class="fas fa-check"></i> Apply Filters
          </button>
          <button id="cancelDashboardFiltersBtn" class="btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Analytics Filter Modal -->
    <div id="analyticsFilterModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-filter"></i> Analytics Filters</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="analyticsModalDomainFilter">
              <i class="fas fa-globe"></i> Domain:
            </label>
            <select id="analyticsModalDomainFilter" style="width: 100%">
              <option value="all">All Domains</option>
            </select>
          </div>
          <div class="form-group">
            <label for="analyticsModalPageFilter">
              <i class="fas fa-file"></i> Page:
            </label>
            <select id="analyticsModalPageFilter" style="width: 100%">
              <option value="">All Pages (Aggregated)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="analyticsModalRequestTypeFilter">
              <i class="fas fa-filter"></i> Type:
            </label>
            <select id="analyticsModalRequestTypeFilter" style="width: 100%">
              <option value="">All Types</option>
              <option value="xmlhttprequest">XHR/API</option>
              <option value="fetch">Fetch</option>
              <option value="script">Scripts</option>
              <option value="stylesheet">Stylesheets</option>
              <option value="image">Images</option>
              <option value="font">Fonts</option>
              <option value="document">Documents</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="applyAnalyticsFiltersBtn" class="btn-primary">
            <i class="fas fa-check"></i> Apply Filters
          </button>
          <button id="cancelAnalyticsFiltersBtn" class="btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Request Details Modal -->
    <div id="requestDetailsModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-info-circle"></i> Request Details</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body" id="requestDetailsBody">
          <!-- Content populated by JavaScript -->
        </div>
        <div class="modal-footer">
          <button id="closeRequestDetailsBtn" class="btn-secondary">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- cURL Command Modal -->
    <div id="curlCommandModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-terminal"></i> cURL Command</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: 12px; color: var(--text-secondary)">
            Copy and paste this command in your terminal to reproduce the
            request:
          </p>
          <div style="position: relative">
            <pre
              id="curlCommandText"
              style="
                background: var(--bg-secondary);
                padding: 16px;
                border-radius: 4px;
                overflow-x: auto;
                margin: 0;
                font-family: 'Courier New', monospace;
                font-size: 13px;
                line-height: 1.5;
                border: 1px solid var(--border-color);
              "
            ></pre>
            <button
              id="copyCurlBtn"
              class="btn-icon"
              style="
                position: absolute;
                top: 8px;
                right: 8px;
                background: var(--primary-color);
                color: white;
                padding: 8px 12px;
                border-radius: 4px;
              "
              title="Copy to clipboard"
            >
              <i class="fas fa-copy"></i> Copy
            </button>
          </div>
          <div
            style="
              margin-top: 16px;
              padding: 12px;
              background: var(--bg-tertiary);
              border-radius: 4px;
              border-left: 3px solid var(--info-color);
            "
          >
            <p style="margin: 0; font-size: 13px; color: var(--text-secondary)">
              <i class="fas fa-info-circle"></i>
              <strong>Future Feature:</strong> Execute this command directly and
              view the request/response details.
            </p>
          </div>
        </div>
        <div class="modal-footer">
          <button id="closeCurlModalBtn" class="btn-secondary">Close</button>
        </div>
      </div>
    </div>

    <script type="module" src="options.js"></script>
  </body>
</html>
